<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тест виправлення кошика</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .cart-item {
            display: flex;
            align-items: center;
            padding: 10px;
            border: 1px solid #eee;
            margin: 10px 0;
            border-radius: 5px;
        }
        .cart-item img {
            width: 60px;
            height: 60px;
            object-fit: cover;
            margin-right: 15px;
        }
        .cart-item-info {
            flex: 1;
        }
        .cart-item-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .cart-item-price {
            color: #666;
        }
        .color-block {
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .color-circle {
            display: inline-block;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            margin: 5px;
            cursor: pointer;
            border: 2px solid #ddd;
        }
        .color-circle.selected {
            border-color: #60A5FA;
        }
        .price-display {
            font-size: 18px;
            font-weight: bold;
            margin: 10px 0;
            padding: 10px;
            background: #f5f5f5;
            border-radius: 5px;
        }
        button {
            background: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #45a049;
        }
    </style>
</head>
<body>
    <h1>Тест виправлення кошика</h1>
    
    <div class="test-section">
        <h2>Симуляція товару з блоками кольорів</h2>
        
        <div class="color-block">
            <h3>Блок 1: Колір корпусу</h3>
            <div id="color-options-1-0">
                <div class="color-circle" data-index="0" data-block-index="0" style="background: #8B4513;" onclick="selectColor(1, 0, 0)">
                    <span>Коричневий (+100 грн)</span>
                </div>
                <div class="color-circle" data-index="1" data-block-index="0" style="background: #000000;" onclick="selectColor(1, 0, 1)">
                    <span>Чорний (+0 грн)</span>
                </div>
                <div class="color-circle" data-index="2" data-block-index="0" style="background: #FFFFFF;" onclick="selectColor(1, 0, 2)">
                    <span>Білий (+50 грн)</span>
                </div>
            </div>
        </div>
        
        <div class="color-block">
            <h3>Блок 2: Колір фасаду</h3>
            <div id="color-options-1-1">
                <div class="color-circle" data-index="0" data-block-index="1" style="background: #FFD700;" onclick="selectColor(1, 1, 3)">
                    <span>Золотий (+200 грн)</span>
                </div>
                <div class="color-circle" data-index="1" data-block-index="1" style="background: #C0C0C0;" onclick="selectColor(1, 1, 4)">
                    <span>Срібний (+150 грн)</span>
                </div>
                <div class="color-circle" data-index="2" data-block-index="1" style="background: #CD7F32;" onclick="selectColor(1, 1, 5)">
                    <span>Бронзовий (+75 грн)</span>
                </div>
            </div>
        </div>
        
        <div class="price-display">
            <strong>Базова ціна:</strong> 1000 грн<br>
            <strong>Поточна ціна:</strong> <span id="current-price">1000</span> грн
        </div>
        
        <button onclick="addToCart()">Додати в кошик</button>
        <button onclick="clearCart()">Очистити кошик</button>
    </div>
    
    <div class="test-section">
        <h2>Кошик</h2>
        <div id="cart-display">
            <p>Кошик порожній</p>
        </div>
    </div>
    
    <script>
        // Симуляція даних
        const selectedColors = {};
        const cart = [];
        const productId = '1';
        
        // Базова ціна товару
        const basePrice = 1000;
        
        // Кольори з цінами
        const colors = [
            { globalIndex: 0, name: 'Коричневий', priceChange: 100, blockIndex: 0 },
            { globalIndex: 1, name: 'Чорний', priceChange: 0, blockIndex: 0 },
            { globalIndex: 2, name: 'Білий', priceChange: 50, blockIndex: 0 },
            { globalIndex: 3, name: 'Золотий', priceChange: 200, blockIndex: 1 },
            { globalIndex: 4, name: 'Срібний', priceChange: 150, blockIndex: 1 },
            { globalIndex: 5, name: 'Бронзовий', priceChange: 75, blockIndex: 1 }
        ];
        
        // Функція вибору кольору
        function selectColor(productId, blockIndex, globalIndex) {
            if (!selectedColors[productId]) {
                selectedColors[productId] = {};
            }
            selectedColors[productId][blockIndex] = globalIndex;
            
            // Оновлюємо підсвічування
            const colorCircles = document.querySelectorAll(`#color-options-${productId}-${blockIndex} .color-circle`);
            colorCircles.forEach((circle, idx) => {
                if (idx === globalIndex % 3) {
                    circle.classList.add('selected');
                } else {
                    circle.classList.remove('selected');
                }
            });
            
            updatePrice();
        }
        
        // Функція оновлення ціни
        function updatePrice() {
            let totalPrice = basePrice;
            const selected = selectedColors[productId];
            
            if (selected) {
                Object.values(selected).forEach(globalIndex => {
                    const color = colors.find(c => c.globalIndex === globalIndex);
                    if (color) {
                        totalPrice += color.priceChange;
                    }
                });
            }
            
            document.getElementById('current-price').textContent = totalPrice;
        }
        
        // Функція додавання в кошик
        function addToCart() {
            const selected = selectedColors[productId];
            
            if (!selected || Object.keys(selected).length < 2) {
                alert('Виберіть колір з кожного блоку!');
                return;
            }
            
            // Створюємо об'єкт кольорів для кошика
            const selectedColorsForCart = [];
            Object.entries(selected).forEach(([blockIndex, globalIndex]) => {
                const color = colors.find(c => c.globalIndex === globalIndex);
                if (color) {
                    selectedColorsForCart.push(color);
                }
            });
            
            // Розраховуємо ціну
            let totalPrice = basePrice;
            selectedColorsForCart.forEach(color => {
                totalPrice += color.priceChange;
            });
            
            const cartItem = {
                id: productId,
                name: 'Тестовий товар',
                price: totalPrice,
                quantity: 1,
                colors: selectedColorsForCart
            };
            
            cart.push(cartItem);
            updateCartDisplay();
            
            alert(`Товар додано в кошик! Ціна: ${totalPrice} грн`);
        }
        
        // Функція оновлення відображення кошика
        function updateCartDisplay() {
            const cartDisplay = document.getElementById('cart-display');
            
            if (cart.length === 0) {
                cartDisplay.innerHTML = '<p>Кошик порожній</p>';
                return;
            }
            
            let html = '';
            cart.forEach((item, index) => {
                const colorNames = item.colors.map(color => color.name).join(', ');
                html += `
                    <div class="cart-item">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjYwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRkZGRkZGIi8+Cjx0ZXh0IHg9IjMwIiB5PSIzNSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjEyIiBmaWxsPSIjNjY2IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iLjNlbSI+0KLQvtC70YzQutC+INGC0L7QsdC+0LvQvtCy0L7QujwvdGV4dD4KPC9zdmc+" alt="Товар">
                        <div class="cart-item-info">
                            <div class="cart-item-name">${item.name} (${colorNames})</div>
                            <div class="cart-item-price">${item.price} грн x ${item.quantity}</div>
                        </div>
                        <button onclick="removeFromCart(${index})">Видалити</button>
                    </div>
                `;
            });
            
            cartDisplay.innerHTML = html;
        }
        
        // Функція видалення з кошика
        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCartDisplay();
        }
        
        // Функція очищення кошика
        function clearCart() {
            cart.length = 0;
            updateCartDisplay();
        }
        
        // Ініціалізація
        updatePrice();
        updateCartDisplay();
    </script>
</body>
</html> 